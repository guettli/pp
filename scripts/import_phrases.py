#!/usr/bin/env python3
"""
Import new phrases from a text file into phrases-{lang}.yaml

Features:
- Reads phrases from a text file (one per line)
- Finds matching emoji from the emoji database
- Avoids duplicates
- Adds phrases to the YAML file
- Automatically runs update-ipa.ts and update-difficulty.py

Usage:
    python scripts/import_phrases.py new-en.txt phrases-en-GB.yaml
    python scripts/import_phrases.py new-de.txt phrases-de-DE.yaml
"""

import argparse
import sys
import subprocess
from pathlib import Path
import yaml


# Inverted emoji map for looking up emojis by word
# This is derived from the EMOJI_WORD_MAP in extract_emoji_low_aoa.py
WORD_TO_EMOJI = {
    "cat": "ğŸ±",
    "dog": "ğŸ¶",
    "mouse": "ğŸ­",
    "hamster": "ğŸ¹",
    "rabbit": "ğŸ°",
    "fox": "ğŸ¦Š",
    "bear": "ğŸ»",
    "panda": "ğŸ¼",
    "koala": "ğŸ¨",
    "tiger": "ğŸ¦",
    "lion": "ğŸ¦",
    "cow": "ğŸ®",
    "pig": "ğŸ·",
    "frog": "ğŸ¸",
    "monkey": "ğŸµ",
    "gorilla": "ğŸ¦",
    "chicken": "ğŸ”",
    "penguin": "ğŸ§",
    "bird": "ğŸ¦",
    "chick": "ğŸ¤",
    "duck": "ğŸ¦†",
    "eagle": "ğŸ¦…",
    "owl": "ğŸ¦‰",
    "bat": "ğŸ¦‡",
    "wolf": "ğŸº",
    "boar": "ğŸ—",
    "horse": "ğŸ´",
    "unicorn": "ğŸ¦„",
    "bee": "ğŸ",
    "caterpillar": "ğŸ›",
    "butterfly": "ğŸ¦‹",
    "snail": "ğŸŒ",
    "ladybug": "ğŸ",
    "ant": "ğŸœ",
    "cricket": "ğŸ¦—",
    "spider": "ğŸ•·ï¸",
    "scorpion": "ğŸ¦‚",
    "turtle": "ğŸ¢",
    "snake": "ğŸ",
    "lizard": "ğŸ¦",
    "dinosaur": "ğŸ¦–",
    "octopus": "ğŸ™",
    "squid": "ğŸ¦‘",
    "crab": "ğŸ¦€",
    "fish": "ğŸŸ",
    "dolphin": "ğŸ¬",
    "shark": "ğŸ¦ˆ",
    "whale": "ğŸ³",
    "crocodile": "ğŸŠ",
    "leopard": "ğŸ†",
    "elephant": "ğŸ˜",
    "rhino": "ğŸ¦",
    "hippo": "ğŸ¦›",
    "camel": "ğŸª",
    "giraffe": "ğŸ¦’",
    "buffalo": "ğŸƒ",
    "ox": "ğŸ‚",
    "sheep": "ğŸ‘",
    "goat": "ğŸ",
    "deer": "ğŸ¦Œ",
    "poodle": "ğŸ©",
    "rooster": "ğŸ“",
    "turkey": "ğŸ¦ƒ",
    "dove": "ğŸ•Šï¸",
    "peacock": "ğŸ¦š",
    "parrot": "ğŸ¦œ",
    "swan": "ğŸ¦¢",
    "flamingo": "ğŸ¦©",
    "tree": "ğŸŒ³",
    "palm": "ğŸŒ´",
    "cactus": "ğŸŒµ",
    "wheat": "ğŸŒ¾",
    "herb": "ğŸŒ¿",
    "clover": "â˜˜ï¸",
    "leaf": "ğŸ",
    "flower": "ğŸŒ¸",
    "sunflower": "ğŸŒ»",
    "rose": "ğŸŒ¹",
    "tulip": "ğŸŒ·",
    "seedling": "ğŸŒ±",
    "chestnut": "ğŸŒ°",
    "apple": "ğŸ",
    "orange": "ğŸŠ",
    "lemon": "ğŸ‹",
    "banana": "ğŸŒ",
    "watermelon": "ğŸ‰",
    "grapes": "ğŸ‡",
    "strawberry": "ğŸ“",
    "melon": "ğŸˆ",
    "cherry": "ğŸ’",
    "peach": "ğŸ‘",
    "mango": "ğŸ¥­",
    "pineapple": "ğŸ",
    "coconut": "ğŸ¥¥",
    "kiwi": "ğŸ¥",
    "tomato": "ğŸ…",
    "eggplant": "ğŸ†",
    "avocado": "ğŸ¥‘",
    "broccoli": "ğŸ¥¦",
    "lettuce": "ğŸ¥¬",
    "cucumber": "ğŸ¥’",
    "pepper": "ğŸŒ¶ï¸",
    "corn": "ğŸŒ½",
    "carrot": "ğŸ¥•",
    "garlic": "ğŸ§„",
    "onion": "ğŸ§…",
    "potato": "ğŸ¥”",
    "croissant": "ğŸ¥",
    "bread": "ğŸ",
    "pretzel": "ğŸ¥¨",
    "bagel": "ğŸ¥¯",
    "pancake": "ğŸ¥",
    "waffle": "ğŸ§‡",
    "cheese": "ğŸ§€",
    "meat": "ğŸ–",
    "steak": "ğŸ¥©",
    "bacon": "ğŸ¥“",
    "burger": "ğŸ”",
    "fries": "ğŸŸ",
    "pizza": "ğŸ•",
    "hotdog": "ğŸŒ­",
    "sandwich": "ğŸ¥ª",
    "taco": "ğŸŒ®",
    "burrito": "ğŸŒ¯",
    "salad": "ğŸ¥—",
    "paella": "ğŸ¥˜",
    "pasta": "ğŸ",
    "noodle": "ğŸœ",
    "stew": "ğŸ²",
    "curry": "ğŸ›",
    "sushi": "ğŸ£",
    "bento": "ğŸ±",
    "dumpling": "ğŸ¥Ÿ",
    "shrimp": "ğŸ¤",
    "rice": "ğŸ™",
    "fishcake": "ğŸ¥",
    "cookie": "ğŸ¥ ",
    "mooncake": "ğŸ¥®",
    "oden": "ğŸ¢",
    "dango": "ğŸ¡",
    "ice": "ğŸ§",
    "pie": "ğŸ¥§",
    "cupcake": "ğŸ§",
    "cake": "ğŸ°",
    "pudding": "ğŸ®",
    "candy": "ğŸ­",
    "chocolate": "ğŸ«",
    "popcorn": "ğŸ¿",
    "donut": "ğŸ©",
    "peanut": "ğŸ¥œ",
    "honey": "ğŸ¯",
    "milk": "ğŸ¥›",
    "bottle": "ğŸ¼",
    "coffee": "â˜•",
    "tea": "ğŸµ",
    "sake": "ğŸ¶",
    "champagne": "ğŸ¾",
    "wine": "ğŸ·",
    "cocktail": "ğŸ¸",
    "juice": "ğŸ¹",
    "beer": "ğŸº",
    "whiskey": "ğŸ¥ƒ",
    "soda": "ğŸ¥¤",
    "sun": "â˜€ï¸",
    "cloud": "â˜ï¸",
    "rain": "ğŸŒ§ï¸",
    "storm": "â›ˆï¸",
    "lightning": "ğŸŒ©ï¸",
    "snow": "ğŸŒ¨ï¸",
    "snowman": "â˜ƒï¸",
    "wind": "ğŸŒ¬ï¸",
    "tornado": "ğŸŒªï¸",
    "fog": "ğŸŒ«ï¸",
    "rainbow": "ğŸŒˆ",
    "moon": "ğŸŒ™",
    "star": "â­",
    "sparkle": "âœ¨",
    "dizzy": "ğŸ’«",
    "comet": "â˜„ï¸",
    "house": "ğŸ ",
    "houses": "ğŸ˜ï¸",
    "building": "ğŸ—ï¸",
    "factory": "ğŸ­",
    "office": "ğŸ¢",
    "store": "ğŸ¬",
    "post": "ğŸ£",
    "hospital": "ğŸ¥",
    "bank": "ğŸ¦",
    "hotel": "ğŸ¨",
    "school": "ğŸ«",
    "church": "ğŸ’’",
    "museum": "ğŸ›ï¸",
    "mosque": "ğŸ•Œ",
    "temple": "ğŸ›•",
    "synagogue": "ğŸ•",
    "shrine": "â›©ï¸",
    "japan": "ğŸ—¾",
    "carousel": "ğŸ ",
    "wheel": "ğŸ¡",
    "coaster": "ğŸ¢",
    "barber": "ğŸ’ˆ",
    "circus": "ğŸª",
    "car": "ğŸš—",
    "taxi": "ğŸš•",
    "bus": "ğŸšŒ",
    "police": "ğŸš“",
    "ambulance": "ğŸš‘",
    "truck": "ğŸš›",
    "van": "ğŸš",
    "tractor": "ğŸšœ",
    "cane": "ğŸ¦¯",
    "wheelchair": "ğŸ¦½",
    "scooter": "ğŸ›´",
    "bicycle": "ğŸš²",
    "motorcycle": "ğŸï¸",
    "rickshaw": "ğŸ›º",
    "siren": "ğŸš¨",
    "cable": "ğŸš¡",
    "monorail": "ğŸšŸ",
    "tram": "ğŸš‹",
    "train": "ğŸš‚",
    "metro": "ğŸš‡",
    "station": "ğŸš‰",
    "airplane": "âœˆï¸",
    "seat": "ğŸ’º",
    "helicopter": "ğŸš",
    "satellite": "ğŸ›°ï¸",
    "rocket": "ğŸš€",
    "ufo": "ğŸ›¸",
    "canoe": "ğŸ›¶",
    "sailboat": "â›µ",
    "boat": "ğŸš¤",
    "ship": "ğŸš¢",
    "ferry": "â›´ï¸",
    "anchor": "âš“",
    "fuel": "â›½",
    "construction": "ğŸš§",
    "light": "ğŸš¦",
    "stop": "ğŸš",
    "map": "ğŸ—ºï¸",
    "statue": "ğŸ—¿",
    "tower": "ğŸ—¼",
    "liberty": "ğŸ—½",
    "fountain": "â›²",
    "umbrella": "â›±ï¸",
    "beach": "ğŸ–ï¸",
    "island": "ğŸï¸",
    "ball": "âš½",
    "basketball": "ğŸ€",
    "football": "ğŸˆ",
    "baseball": "âš¾",
    "softball": "ğŸ¥",
    "tennis": "ğŸ¾",
    "volleyball": "ğŸ",
    "rugby": "ğŸ‰",
    "frisbee": "ğŸ¥",
    "pool": "ğŸ±",
    "yoyo": "ğŸª€",
    "ping": "ğŸ“",
    "badminton": "ğŸ¸",
    "hockey": "ğŸ’",
    "lacrosse": "ğŸ¥",
    "cricket": "ğŸ",
    "goal": "ğŸ¥…",
    "golf": "â›³",
    "archery": "ğŸ¹",
    "fishing": "ğŸ£",
    "diving": "ğŸ¤¿",
    "boxing": "ğŸ¥Š",
    "martial": "ğŸ¥‹",
    "shirt": "ğŸ½",
    "skateboard": "ğŸ›¹",
    "skate": "ğŸ›¼",
    "curling": "ğŸ¥Œ",
    "ski": "ğŸ¿",
    "snowboard": "ğŸ‚",
    "parachute": "ğŸª‚",
    "weight": "ğŸ‹ï¸",
    "wrestling": "ğŸ¤¼",
    "cartwheel": "ğŸ¤¸",
    "fencing": "ğŸ¤º",
    "handball": "ğŸ¤¾",
    "swim": "ğŸŠ",
    "surf": "ğŸ„",
    "row": "ğŸš£",
    "climb": "ğŸ§—",
    "bike": "ğŸš´",
    "juggle": "ğŸ¤¹",
    "yoga": "ğŸ§˜",
    "watch": "âŒš",
    "phone": "ğŸ“±",
    "computer": "ğŸ’»",
    "keyboard": "âŒ¨ï¸",
    "printer": "ğŸ–¨ï¸",
    "mouse": "ğŸ–±ï¸",
    "trackball": "ğŸ–²ï¸",
    "joystick": "ğŸ•¹ï¸",
    "clamp": "ğŸ—œï¸",
    "disk": "ğŸ’¾",
    "cd": "ğŸ’¿",
    "dvd": "ğŸ“€",
    "tape": "ğŸ“¼",
    "camera": "ğŸ“·",
    "video": "ğŸ“¹",
    "projector": "ğŸ“½ï¸",
    "film": "ğŸï¸",
    "pager": "ğŸ“Ÿ",
    "fax": "ğŸ“ ",
    "tv": "ğŸ“º",
    "radio": "ğŸ“»",
    "microphone": "ğŸ™ï¸",
    "slider": "ğŸšï¸",
    "knobs": "ğŸ›ï¸",
    "compass": "ğŸ§­",
    "stopwatch": "â±ï¸",
    "timer": "â²ï¸",
    "clock": "â°",
    "hourglass": "âŒ›",
    "battery": "ğŸ”‹",
    "plug": "ğŸ”Œ",
    "bulb": "ğŸ’¡",
    "flashlight": "ğŸ”¦",
    "candle": "ğŸ•¯ï¸",
    "lamp": "ğŸª”",
    "extinguisher": "ğŸ§¯",
    "drum": "ğŸ›¢ï¸",
    "money": "ğŸ’°",
    "dollar": "ğŸ’µ",
    "yen": "ğŸ’´",
    "euro": "ğŸ’¶",
    "pound": "ğŸ’·",
    "card": "ğŸ’³",
    "gem": "ğŸ’",
    "scale": "âš–ï¸",
    "toolbox": "ğŸ§°",
    "wrench": "ğŸ”§",
    "hammer": "ğŸ”¨",
    "tools": "ğŸ› ï¸",
    "pick": "â›ï¸",
    "bolt": "ğŸ”©",
    "gear": "âš™ï¸",
    "brick": "ğŸ§±",
    "chain": "â›“ï¸",
    "magnet": "ğŸ§²",
    "gun": "ğŸ”«",
    "bomb": "ğŸ’£",
    "firecracker": "ğŸ§¨",
    "axe": "ğŸª“",
    "knife": "ğŸ”ª",
    "sword": "ğŸ—¡ï¸",
    "swords": "âš”ï¸",
    "shield": "ğŸ›¡ï¸",
    "cigarette": "ğŸš¬",
    "coffin": "âš°ï¸",
    "urn": "âš±ï¸",
    "amphora": "ğŸº",
    "beads": "ğŸ“¿",
    "alembic": "âš—ï¸",
    "telescope": "ğŸ”­",
    "microscope": "ğŸ”¬",
    "hole": "ğŸ•³ï¸",
    "pill": "ğŸ’Š",
    "syringe": "ğŸ’‰",
    "bandage": "ğŸ©¹",
    "stethoscope": "ğŸ©º",
    "door": "ğŸšª",
    "elevator": "ğŸ›—",
    "mirror": "ğŸª",
    "window": "ğŸªŸ",
    "bed": "ğŸ›ï¸",
    "couch": "ğŸ›‹ï¸",
    "chair": "ğŸª‘",
    "toilet": "ğŸš½",
    "shower": "ğŸš¿",
    "bathtub": "ğŸ›",
    "razor": "ğŸª’",
    "lotion": "ğŸ§´",
    "pin": "ğŸ§·",
    "broom": "ğŸ§¹",
    "basket": "ğŸ§º",
    "paper": "ğŸ§»",
    "soap": "ğŸ§¼",
    "sponge": "ğŸ§½",
    "cart": "ğŸ›’",
    "glasses": "ğŸ‘“",
    "sunglasses": "ğŸ•¶ï¸",
    "goggles": "ğŸ¥½",
    "coat": "ğŸ¥¼",
    "vest": "ğŸ¦º",
    "tie": "ğŸ‘”",
    "jeans": "ğŸ‘–",
    "scarf": "ğŸ§£",
    "gloves": "ğŸ§¤",
    "socks": "ğŸ§¦",
    "dress": "ğŸ‘—",
    "kimono": "ğŸ‘˜",
    "sari": "ğŸ¥»",
    "swimsuit": "ğŸ©±",
    "underwear": "ğŸ©²",
    "shorts": "ğŸ©³",
    "bikini": "ğŸ‘™",
    "purse": "ğŸ‘›",
    "bag": "ğŸ‘œ",
    "clutch": "ğŸ‘",
    "backpack": "ğŸ’",
    "shoe": "ğŸ‘",
    "boot": "ğŸ‘¢",
    "sandal": "ğŸ‘¡",
    "heel": "ğŸ‘ ",
    "crown": "ğŸ‘‘",
    "hat": "ğŸ‘’",
    "cap": "ğŸ§¢",
    "helmet": "â›‘ï¸",
    "lipstick": "ğŸ’„",
    "ring": "ğŸ’",
    "briefcase": "ğŸ’¼",
    "heart": "â¤ï¸",
    "peace": "â˜®ï¸",
    "cross": "âœï¸",
    "crescent": "â˜ªï¸",
    "om": "ğŸ•‰ï¸",
    "menorah": "ğŸ•",
    "yin": "â˜¯ï¸",
    "worship": "ğŸ›",
    "ophiuchus": "â›",
    "aries": "â™ˆ",
    "taurus": "â™‰",
    "gemini": "â™Š",
    "cancer": "â™‹",
    "leo": "â™Œ",
    "virgo": "â™",
    "libra": "â™",
    "scorpio": "â™",
    "sagittarius": "â™",
    "capricorn": "â™‘",
    "aquarius": "â™’",
    "pisces": "â™“",
    "id": "ğŸ†”",
    "atom": "âš›ï¸",
    "accept": "ğŸ‰‘",
    "radioactive": "â˜¢ï¸",
    "biohazard": "â˜£ï¸",
    "off": "ğŸ“´",
    "vibrate": "ğŸ“³",
    "vs": "ğŸ†š",
    "bargain": "ğŸ‰",
    "secret": "ãŠ™ï¸",
    "congratulations": "ãŠ—ï¸",
    "pass": "ğŸˆ´",
    "full": "ğŸˆµ",
    "discount": "ğŸˆ¹",
    "prohibit": "ğŸˆ²",
    "a": "ğŸ…°ï¸",
    "b": "ğŸ…±ï¸",
    "ab": "ğŸ†",
    "cl": "ğŸ†‘",
    "o": "ğŸ…¾ï¸",
    "sos": "ğŸ†˜",
    "circle": "â­•",
    "entry": "â›”",
    "name": "ğŸ“›",
    "prohibited": "ğŸš«",
    "hundred": "ğŸ’¯",
    "anger": "ğŸ’¢",
    "hot": "â™¨ï¸",
    "pedestrian": "ğŸš·",
    "litter": "ğŸš¯",
    "water": "ğŸš±",
    "underage": "ğŸ”",
    "smoking": "ğŸš­",
    "exclamation": "â—",
    "question": "â“",
    "wavy": "ã€½ï¸",
    "warning": "âš ï¸",
    "children": "ğŸš¸",
    "trident": "ğŸ”±",
    "fleur": "âšœï¸",
    "beginner": "ğŸ”°",
    "recycle": "â™»ï¸",
    "check": "âœ…",
    "reserved": "ğŸˆ¯",
    "chart": "ğŸ’¹",
    "asterisk": "âœ³ï¸",
    "m": "â“‚ï¸",
    "cyclone": "ğŸŒ€",
    "sleep": "ğŸ’¤",
    "atm": "ğŸ§",
    "wc": "ğŸš¾",
    "parking": "ğŸ…¿ï¸",
    "vacancy": "ğŸˆ³",
    "service": "ğŸˆ‚ï¸",
    "passport": "ğŸ›‚",
    "customs": "ğŸ›ƒ",
    "baggage": "ğŸ›„",
    "luggage": "ğŸ›…",
    "men": "ğŸš¹",
    "women": "ğŸšº",
    "baby": "ğŸš¼",
    "restroom": "ğŸš»",
    "cinema": "ğŸ¦",
    "signal": "ğŸ“¶",
    "here": "ğŸˆ",
    "symbols": "ğŸ”£",
    "information": "â„¹ï¸",
    "abc": "ğŸ”¤",
    "abcd": "ğŸ”¡",
    "capital": "ğŸ” ",
    "ng": "ğŸ†–",
    "ok": "ğŸ†—",
    "up": "ğŸ†™",
    "cool": "ğŸ†’",
    "new": "ğŸ†•",
    "free": "ğŸ†“",
    "zero": "0ï¸âƒ£",
    "one": "1ï¸âƒ£",
    "two": "2ï¸âƒ£",
    "three": "3ï¸âƒ£",
    "four": "4ï¸âƒ£",
    "five": "5ï¸âƒ£",
    "six": "6ï¸âƒ£",
    "seven": "7ï¸âƒ£",
    "eight": "8ï¸âƒ£",
    "nine": "9ï¸âƒ£",
    "ten": "ğŸ”Ÿ",
    "eye": "ğŸ‘ï¸",
    "eyes": "ğŸ‘€",
    "ear": "ğŸ‘‚",
    "nose": "ğŸ‘ƒ",
    "mouth": "ğŸ‘„",
    "tongue": "ğŸ‘…",
    "tooth": "ğŸ¦·",
    "bone": "ğŸ¦´",
    "child": "ğŸ§’",
    "boy": "ğŸ‘¦",
    "girl": "ğŸ‘§",
    "person": "ğŸ§‘",
    "man": "ğŸ‘¨",
    "woman": "ğŸ‘©",
    "older": "ğŸ§“",
    "frown": "ğŸ™",
    "pout": "ğŸ™",
    "no": "ğŸ™…",
    "raise": "ğŸ™‹",
    "deaf": "ğŸ§",
    "bow": "ğŸ™‡",
    "facepalm": "ğŸ¤¦",
    "shrug": "ğŸ¤·",
    "detective": "ğŸ•µï¸",
    "guard": "ğŸ’‚",
    "prince": "ğŸ¤´",
    "princess": "ğŸ‘¸",
    "turban": "ğŸ‘³",
    "headscarf": "ğŸ§•",
    "tuxedo": "ğŸ¤µ",
    "bride": "ğŸ‘°",
    "pregnant": "ğŸ¤°",
    "feeding": "ğŸ¤±",
    "angel": "ğŸ‘¼",
    "santa": "ğŸ…",
    "superhero": "ğŸ¦¸",
    "supervillain": "ğŸ¦¹",
    "mage": "ğŸ§™",
    "fairy": "ğŸ§š",
    "vampire": "ğŸ§›",
    "merperson": "ğŸ§œ",
    "elf": "ğŸ§",
    "genie": "ğŸ§",
    "zombie": "ğŸ§Ÿ",
    "massage": "ğŸ’†",
    "haircut": "ğŸ’‡",
    "walk": "ğŸš¶",
    "stand": "ğŸ§",
    "kneel": "ğŸ§",
    "blind": "ğŸ‘¨â€ğŸ¦¯",
    "run": "ğŸƒ",
    "dance": "ğŸ’ƒ",
    "suit": "ğŸ•´ï¸",
    "bunny": "ğŸ‘¯",
    "sauna": "ğŸ§–",
    "fence": "ğŸ¤º",
    "polo": "ğŸ¤½",
    "lotus": "ğŸ§˜",
    "bath": "ğŸ›€",
    "couple": "ğŸ‘«",
    "kiss": "ğŸ’",
    "family": "ğŸ‘ª",
    "speak": "ğŸ—£ï¸",
    "bust": "ğŸ‘¤",
    "busts": "ğŸ‘¥",
    "footprints": "ğŸ‘£",
    "hands": "ğŸ¤²",
    "clap": "ğŸ‘",
    "handshake": "ğŸ¤",
    "thumbs": "ğŸ‘",
    "fist": "ğŸ‘Š",
    "fingers": "ğŸ¤",
    "victory": "âœŒï¸",
    "love": "ğŸ¤Ÿ",
    "rock": "ğŸ¤˜",
    "pinch": "ğŸ¤",
    "left": "ğŸ‘ˆ",
    "right": "ğŸ‘‰",
    "down": "ğŸ‘‡",
    "hand": "âœ‹",
    "spock": "ğŸ––",
    "wave": "ğŸ‘‹",
    "call": "ğŸ¤™",
    "muscle": "ğŸ’ª",
    "arm": "ğŸ¦¾",
    "finger": "ğŸ–•",
    "write": "âœï¸",
    "pray": "ğŸ™",
    "foot": "ğŸ¦¶",
    "leg": "ğŸ¦µ",
    "ladder": "ğŸªœ",
    "plunger": "ğŸª ",
    "bucket": "ğŸª£",
    "fire": "ğŸ§¯",
    "pencil": "âœï¸",
    "pen": "ğŸ–Šï¸",
    "brush": "ğŸ–Œï¸",
    "crayon": "ğŸ–ï¸",
    "memo": "ğŸ“",
    "folder": "ğŸ“",
    "dividers": "ğŸ—‚ï¸",
    "calendar": "ğŸ“…",
    "notepad": "ğŸ—’ï¸",
    "cards": "ğŸ“‡",
    "clipboard": "ğŸ“‹",
    "clip": "ğŸ“",
    "clips": "ğŸ–‡ï¸",
    "ruler": "ğŸ“",
    "triangle": "ğŸ“",
    "scissors": "âœ‚ï¸",
    "box": "ğŸ—ƒï¸",
    "cabinet": "ğŸ—„ï¸",
    "trash": "ğŸ—‘ï¸",
    "lock": "ğŸ”’",
    "unlock": "ğŸ”“",
    "key": "ğŸ”‘",
    "book": "ğŸ“•",
    "notebook": "ğŸ“”",
    "ledger": "ğŸ“’",
    "page": "ğŸ“ƒ",
    "scroll": "ğŸ“œ",
    "newspaper": "ğŸ“°",
    "bookmark": "ğŸ“‘",
    "label": "ğŸ·ï¸",
    "receipt": "ğŸ§¾",
    "score": "ğŸ¼",
    "note": "ğŸµ",
    "notes": "ğŸ¶",
    "headphone": "ğŸ§",
    "saxophone": "ğŸ·",
    "guitar": "ğŸ¸",
    "trumpet": "ğŸº",
    "violin": "ğŸ»",
    "banjo": "ğŸª•",
    "clapper": "ğŸ¬",
    "palette": "ğŸ¨",
    "slot": "ğŸ°",
    "dice": "ğŸ²",
    "dart": "ğŸ¯",
    "bowling": "ğŸ³",
    "game": "ğŸ®",
    "joker": "ğŸƒ",
    "mahjong": "ğŸ€„",
    "gift": "ğŸ",
    "ribbon": "ğŸ€",
    "confetti": "ğŸŠ",
    "tanabata": "ğŸ‹",
    "dolls": "ğŸ",
    "carp": "ğŸ",
    "chime": "ğŸ",
    "envelope": "ğŸ§§",
    "party": "ğŸ‰",
}

# German word mapping (includes both base word and article forms)
GERMAN_WORD_TO_EMOJI = {
    "katze": "ğŸ±",
    "die katze": "ğŸ±",
    "hund": "ğŸ¶",
    "der hund": "ğŸ¶",
    "maus": "ğŸ­",
    "die maus": "ğŸ­",
    "hamster": "ğŸ¹",
    "der hamster": "ğŸ¹",
    "kaninchen": "ğŸ°",
    "das kaninchen": "ğŸ°",
    "fuchs": "ğŸ¦Š",
    "der fuchs": "ğŸ¦Š",
    "bÃ¤r": "ğŸ»",
    "der bÃ¤r": "ğŸ»",
    "panda": "ğŸ¼",
    "der panda": "ğŸ¼",
    "tiger": "ğŸ¦",
    "der tiger": "ğŸ¦",
    "lÃ¶we": "ğŸ¦",
    "der lÃ¶we": "ğŸ¦",
    "kuh": "ğŸ®",
    "die kuh": "ğŸ®",
    "schwein": "ğŸ·",
    "das schwein": "ğŸ·",
    "frosch": "ğŸ¸",
    "der frosch": "ğŸ¸",
    "affe": "ğŸµ",
    "der affe": "ğŸµ",
    "huhn": "ğŸ”",
    "das huhn": "ğŸ”",
    "pinguin": "ğŸ§",
    "der pinguin": "ğŸ§",
    "vogel": "ğŸ¦",
    "der vogel": "ğŸ¦",
    "kÃ¼ken": "ğŸ¤",
    "das kÃ¼ken": "ğŸ¤",
    "ente": "ğŸ¦†",
    "die ente": "ğŸ¦†",
    "adler": "ğŸ¦…",
    "der adler": "ğŸ¦…",
    "eule": "ğŸ¦‰",
    "die eule": "ğŸ¦‰",
    "fledermaus": "ğŸ¦‡",
    "die fledermaus": "ğŸ¦‡",
    "wolf": "ğŸº",
    "der wolf": "ğŸº",
    "pferd": "ğŸ´",
    "das pferd": "ğŸ´",
    "biene": "ğŸ",
    "die biene": "ğŸ",
    "schmetterling": "ğŸ¦‹",
    "der schmetterling": "ğŸ¦‹",
    "schnecke": "ğŸŒ",
    "die schnecke": "ğŸŒ",
    "ameise": "ğŸœ",
    "die ameise": "ğŸœ",
    "spinne": "ğŸ•·ï¸",
    "die spinne": "ğŸ•·ï¸",
    "schildkrÃ¶te": "ğŸ¢",
    "die schildkrÃ¶te": "ğŸ¢",
    "schlange": "ğŸ",
    "die schlange": "ğŸ",
    "fisch": "ğŸŸ",
    "der fisch": "ğŸŸ",
    "delfin": "ğŸ¬",
    "der delfin": "ğŸ¬",
    "wal": "ğŸ³",
    "der wal": "ğŸ³",
    "elefant": "ğŸ˜",
    "der elefant": "ğŸ˜",
    "giraffe": "ğŸ¦’",
    "die giraffe": "ğŸ¦’",
    "schaf": "ğŸ‘",
    "das schaf": "ğŸ‘",
    "ziege": "ğŸ",
    "die ziege": "ğŸ",
    "reh": "ğŸ¦Œ",
    "das reh": "ğŸ¦Œ",
    "hahn": "ğŸ“",
    "der hahn": "ğŸ“",
    "baum": "ğŸŒ³",
    "der baum": "ğŸŒ³",
    "blume": "ğŸŒ¸",
    "die blume": "ğŸŒ¸",
    "rose": "ğŸŒ¹",
    "die rose": "ğŸŒ¹",
    "blatt": "ğŸ",
    "das blatt": "ğŸ",
    "apfel": "ğŸ",
    "der apfel": "ğŸ",
    "orange": "ğŸŠ",
    "die orange": "ğŸŠ",
    "zitrone": "ğŸ‹",
    "die zitrone": "ğŸ‹",
    "banane": "ğŸŒ",
    "die banane": "ğŸŒ",
    "wassermelone": "ğŸ‰",
    "die wassermelone": "ğŸ‰",
    "trauben": "ğŸ‡",
    "die trauben": "ğŸ‡",
    "erdbeere": "ğŸ“",
    "die erdbeere": "ğŸ“",
    "kirsche": "ğŸ’",
    "die kirsche": "ğŸ’",
    "tomate": "ğŸ…",
    "die tomate": "ğŸ…",
    "karotte": "ğŸ¥•",
    "die karotte": "ğŸ¥•",
    "kartoffel": "ğŸ¥”",
    "die kartoffel": "ğŸ¥”",
    "brot": "ğŸ",
    "das brot": "ğŸ",
    "kÃ¤se": "ğŸ§€",
    "der kÃ¤se": "ğŸ§€",
    "fleisch": "ğŸ–",
    "das fleisch": "ğŸ–",
    "burger": "ğŸ”",
    "der burger": "ğŸ”",
    "pizza": "ğŸ•",
    "die pizza": "ğŸ•",
    "kuchen": "ğŸ°",
    "der kuchen": "ğŸ°",
    "bonbon": "ğŸ­",
    "das bonbon": "ğŸ­",
    "schokolade": "ğŸ«",
    "die schokolade": "ğŸ«",
    "keks": "ğŸª",
    "der keks": "ğŸª",
    "milch": "ğŸ¥›",
    "die milch": "ğŸ¥›",
    "wasser": "ğŸ’§",
    "das wasser": "ğŸ’§",
    "kaffee": "â˜•",
    "der kaffee": "â˜•",
    "tee": "ğŸµ",
    "der tee": "ğŸµ",
    "saft": "ğŸ¹",
    "der saft": "ğŸ¹",
    "bier": "ğŸº",
    "das bier": "ğŸº",
    "sonne": "â˜€ï¸",
    "die sonne": "â˜€ï¸",
    "wolke": "â˜ï¸",
    "die wolke": "â˜ï¸",
    "regen": "ğŸŒ§ï¸",
    "der regen": "ğŸŒ§ï¸",
    "schnee": "ğŸŒ¨ï¸",
    "der schnee": "ğŸŒ¨ï¸",
    "wind": "ğŸŒ¬ï¸",
    "der wind": "ğŸŒ¬ï¸",
    "regenbogen": "ğŸŒˆ",
    "der regenbogen": "ğŸŒˆ",
    "mond": "ğŸŒ™",
    "der mond": "ğŸŒ™",
    "stern": "â­",
    "der stern": "â­",
    "haus": "ğŸ ",
    "das haus": "ğŸ ",
    "gebÃ¤ude": "ğŸ—ï¸",
    "das gebÃ¤ude": "ğŸ—ï¸",
    "schule": "ğŸ«",
    "die schule": "ğŸ«",
    "krankenhaus": "ğŸ¥",
    "das krankenhaus": "ğŸ¥",
    "kirche": "ğŸ’’",
    "die kirche": "ğŸ’’",
    "auto": "ğŸš—",
    "das auto": "ğŸš—",
    "bus": "ğŸšŒ",
    "der bus": "ğŸšŒ",
    "zug": "ğŸš‚",
    "der zug": "ğŸš‚",
    "fahrrad": "ğŸš²",
    "das fahrrad": "ğŸš²",
    "flugzeug": "âœˆï¸",
    "das flugzeug": "âœˆï¸",
    "boot": "ğŸš¤",
    "das boot": "ğŸš¤",
    "schiff": "ğŸš¢",
    "das schiff": "ğŸš¢",
    "ball": "âš½",
    "der ball": "âš½",
    "uhr": "âŒš",
    "die uhr": "âŒš",
    "telefon": "ğŸ“±",
    "das telefon": "ğŸ“±",
    "computer": "ğŸ’»",
    "der computer": "ğŸ’»",
    "kamera": "ğŸ“·",
    "die kamera": "ğŸ“·",
    "fernseher": "ğŸ“º",
    "der fernseher": "ğŸ“º",
    "geld": "ğŸ’°",
    "das geld": "ğŸ’°",
    "hammer": "ğŸ”¨",
    "der hammer": "ğŸ”¨",
    "messer": "ğŸ”ª",
    "das messer": "ğŸ”ª",
    "tÃ¼r": "ğŸšª",
    "die tÃ¼r": "ğŸšª",
    "fenster": "ğŸªŸ",
    "das fenster": "ğŸªŸ",
    "bett": "ğŸ›ï¸",
    "das bett": "ğŸ›ï¸",
    "stuhl": "ğŸª‘",
    "der stuhl": "ğŸª‘",
    "tisch": "ğŸ½ï¸",
    "der tisch": "ğŸ½ï¸",
    "brille": "ğŸ‘“",
    "die brille": "ğŸ‘“",
    "hemd": "ğŸ‘•",
    "das hemd": "ğŸ‘•",
    "hose": "ğŸ‘–",
    "die hose": "ğŸ‘–",
    "kleid": "ğŸ‘—",
    "das kleid": "ğŸ‘—",
    "schuh": "ğŸ‘",
    "der schuh": "ğŸ‘",
    "hut": "ğŸ‘’",
    "der hut": "ğŸ‘’",
    "herz": "â¤ï¸",
    "das herz": "â¤ï¸",
    "hand": "âœ‹",
    "die hand": "âœ‹",
    "fuÃŸ": "ğŸ¦¶",
    "der fuÃŸ": "ğŸ¦¶",
    "auge": "ğŸ‘ï¸",
    "das auge": "ğŸ‘ï¸",
    "ohr": "ğŸ‘‚",
    "das ohr": "ğŸ‘‚",
    "nase": "ğŸ‘ƒ",
    "die nase": "ğŸ‘ƒ",
    "mund": "ğŸ‘„",
    "der mund": "ğŸ‘„",
    "zahn": "ğŸ¦·",
    "der zahn": "ğŸ¦·",
    "baby": "ğŸ‘¶",
    "das baby": "ğŸ‘¶",
    "kind": "ğŸ§’",
    "das kind": "ğŸ§’",
    "junge": "ğŸ‘¦",
    "der junge": "ğŸ‘¦",
    "mÃ¤dchen": "ğŸ‘§",
    "das mÃ¤dchen": "ğŸ‘§",
    "mann": "ğŸ‘¨",
    "der mann": "ğŸ‘¨",
    "frau": "ğŸ‘©",
    "die frau": "ğŸ‘©",
    "buch": "ğŸ“•",
    "das buch": "ğŸ“•",
    "stift": "ğŸ–Šï¸",
    "der stift": "ğŸ–Šï¸",
    "bleistift": "âœï¸",
    "der bleistift": "âœï¸",
    "papier": "ğŸ“ƒ",
    "das papier": "ğŸ“ƒ",
    "schlÃ¼ssel": "ğŸ”‘",
    "der schlÃ¼ssel": "ğŸ”‘",
    "geschenk": "ğŸ",
    "das geschenk": "ğŸ",
    "ballon": "ğŸˆ",
    "der ballon": "ğŸˆ",
    "flagge": "ğŸ³ï¸",
    "die flagge": "ğŸ³ï¸",
}


def find_emoji_for_word(word: str, lang: str) -> str:
    """Find emoji for a given word based on language."""
    word_lower = word.lower().strip()

    if lang == "en-GB":
        return WORD_TO_EMOJI.get(word_lower, "â“")
    elif lang == "de-DE":
        return GERMAN_WORD_TO_EMOJI.get(word_lower, "â“")
    else:
        return "â“"


def main():
    parser = argparse.ArgumentParser(
        description="Import new phrases from text file into YAML"
    )
    parser.add_argument("input_file", help="Input text file with phrases (one per line)")
    parser.add_argument("yaml_file", help="Target YAML file (phrases-{lang}.yaml)")
    parser.add_argument(
        "--skip-ipa",
        action="store_true",
        help="Skip running update-ipa.ts"
    )
    parser.add_argument(
        "--skip-difficulty",
        action="store_true",
        help="Skip running update-difficulty.py"
    )

    args = parser.parse_args()

    input_file = Path(args.input_file)
    yaml_file = Path(args.yaml_file)

    # Validate files
    if not input_file.exists():
        print(f"Error: Input file not found: {input_file}", file=sys.stderr)
        sys.exit(1)

    if not yaml_file.exists():
        print(f"Error: YAML file not found: {yaml_file}", file=sys.stderr)
        sys.exit(1)

    # Extract language from YAML filename
    import re
    lang_match = re.search(r"phrases-([a-zA-Z-]+)\.yaml", yaml_file.name)
    if not lang_match:
        print("Error: Could not determine language from YAML filename", file=sys.stderr)
        print("Expected format: phrases-{lang}.yaml", file=sys.stderr)
        sys.exit(1)

    lang = lang_match.group(1)
    print(f"Language: {lang}")
    print()

    # Load existing phrases
    print(f"ğŸ“– Loading existing phrases from {yaml_file}...")
    with open(yaml_file, "r", encoding="utf-8") as f:
        existing_phrases = yaml.safe_load(f) or []

    if not isinstance(existing_phrases, list):
        print("Error: Invalid YAML format - expected list", file=sys.stderr)
        sys.exit(1)

    # Build set of existing phrase texts (case-insensitive for better deduplication)
    existing_texts = {p.get("phrase", "").lower() for p in existing_phrases}
    print(f"  Found {len(existing_phrases)} existing phrases")
    print()

    # Load new phrases from input file
    print(f"ğŸ“– Loading new phrases from {input_file}...")
    with open(input_file, "r", encoding="utf-8") as f:
        new_phrases_raw = [line.strip() for line in f if line.strip()]

    print(f"  Found {len(new_phrases_raw)} phrases in input file")
    print()

    # Filter out duplicates and create phrase entries
    new_entries = []
    skipped = []

    for phrase_text in new_phrases_raw:
        phrase_lower = phrase_text.lower()

        if phrase_lower in existing_texts:
            skipped.append(phrase_text)
            continue

        # Find emoji for this phrase
        emoji = find_emoji_for_word(phrase_text, lang)

        # Create new entry
        new_entry = {
            "phrase": phrase_text,
            "emoji": emoji
        }

        new_entries.append(new_entry)
        existing_texts.add(phrase_lower)  # Add to set to avoid duplicates within new phrases

    print("=" * 70)
    print(f"New phrases to add: {len(new_entries)}")
    print(f"Duplicates skipped: {len(skipped)}")
    print("=" * 70)
    print()

    if len(skipped) > 0 and len(skipped) <= 10:
        print("Skipped duplicates:")
        for s in skipped:
            print(f"  - {s}")
        print()

    if len(new_entries) == 0:
        print("âœ… No new phrases to add!")
        sys.exit(0)

    # Add new entries to the list
    all_phrases = existing_phrases + new_entries

    # Write back to YAML file
    print(f"âœï¸  Writing {len(new_entries)} new phrases to {yaml_file}...")
    with open(yaml_file, "w", encoding="utf-8") as f:
        yaml.dump(
            all_phrases,
            f,
            default_flow_style=False,
            allow_unicode=True,
            sort_keys=False,
            width=100,
        )

    print(f"âœ… Added {len(new_entries)} new phrases to {yaml_file}")
    print()

    # Run update-ipa.ts if not skipped
    if not args.skip_ipa:
        print("ğŸ”„ Running update-ipa.ts to add IPA pronunciations...")
        try:
            result = subprocess.run(
                ["./run", "tsx", "scripts/update-ipa.ts", str(yaml_file)],
                cwd=yaml_file.parent.parent,
                capture_output=False,
                text=True
            )
            if result.returncode != 0:
                print("âš ï¸  Warning: update-ipa.ts failed", file=sys.stderr)
            else:
                print("âœ… IPA pronunciations added")
        except Exception as e:
            print(f"âš ï¸  Warning: Could not run update-ipa.ts: {e}", file=sys.stderr)
        print()

    # Run update-difficulty.py if not skipped
    if not args.skip_difficulty:
        print("ğŸ”„ Running update-difficulty.py to add difficulty scores...")
        try:
            result = subprocess.run(
                ["./run", "python3", "scripts/update-difficulty.py", str(yaml_file)],
                cwd=yaml_file.parent.parent,
                capture_output=False,
                text=True
            )
            if result.returncode != 0:
                print("âš ï¸  Warning: update-difficulty.py failed", file=sys.stderr)
            else:
                print("âœ… Difficulty scores added")
        except Exception as e:
            print(f"âš ï¸  Warning: Could not run update-difficulty.py: {e}", file=sys.stderr)
        print()

    print("=" * 70)
    print("âœ… Import complete!")
    print(f"  Total phrases in {yaml_file}: {len(all_phrases)}")
    print("=" * 70)


if __name__ == "__main__":
    main()
